
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png">
    <link href="../_static/favicon-16x16.png" sizes="16x16" rel="icon" type="image/png">
    <title>Options &#8212; xtl 0.1.0dev0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=a4c74b72"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'common/options';</script>
    <script src="../_static/js/version-selector.js?v=0a9e6b73"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tables" href="tables.html" />
    <link rel="prev" title="Shared utilities" href="index.html" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <style>
        /* Version selector styles */
        .version-selector-nav {
            display: inline-flex;
            align-items: center;
            margin: 0 6px 0 8px;
        }
        .version-selector-nav select {
            width: 80px;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid var(--pst-color-border, #ccc);
            background-color: var(--pst-color-background, #fff);
            color: var(--pst-color-text-base, #000);
            font-size: 14px;
        }

        /* Original version selector (hidden on desktop, visible on mobile) */
        .version-selector { display: none; }

        /* Responsive adjustments */
        @media (max-width: 576px) {
            .version-selector-nav { display: none; }
            .version-selector {
                display: block;
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 1000;
                background-color: var(--pst-color-background-offset, var(--pst-color-background, #fff));
                border-radius: 5px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                padding: 10px;
                border: 1px solid var(--pst-color-border, #ddd);
            }
        }
    </style>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
    
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/icon.png" class="logo__image only-light" alt="xtl 0.1.0dev0 documentation - Home"/>
    <script>document.write(`<img src="../_static/icon.png" class="logo__image only-dark" alt="xtl 0.1.0dev0 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Shared utilities</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="tables.html">Tables</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cli/index.html">Command line utilities</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/xtl.autoproc.html"><code class="docutils literal notranslate"><span class="pre">xtl.autoproc</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/modules.html">API documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/xtl.html">xtl</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xtl.common.html"><code class="docutils literal notranslate"><span class="pre">xtl.common</span></code> package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xtl.common.compatibility.html"><code class="docutils literal notranslate"><span class="pre">xtl.common.compatibility</span></code> module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xtl.common.options.html"><code class="docutils literal notranslate"><span class="pre">xtl.common.options</span></code> module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xtl.common.validators.html"><code class="docutils literal notranslate"><span class="pre">xtl.common.validators</span></code> module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xtl.common.serializers.html"><code class="docutils literal notranslate"><span class="pre">xtl.common.serializers</span></code> module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xtl.common.tables.html"><code class="docutils literal notranslate"><span class="pre">xtl.common.tables</span></code> module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xtl.config.html"><code class="docutils literal notranslate"><span class="pre">xtl.config</span></code> package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xtl.config.settings.html"><code class="docutils literal notranslate"><span class="pre">xtl.config.settings</span></code> module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xtl.config.version.html"><code class="docutils literal notranslate"><span class="pre">xtl.config.version</span></code> module</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/common/options.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Options</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quickstart">Quickstart</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-validation">Data validation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-casting">Type casting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-validation">Custom validation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-formatting">Data formatting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-i-o">Model I/O</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-variables">Environment variables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="options">
<h1>Options<a class="headerlink" href="#options" title="Link to this heading">#</a></h1>
<p>The <a class="reference internal" href="../api/xtl.common.options.html#module-xtl.common.options" title="xtl.common.options"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xtl.common.options</span></code></a> module provides an API around <a class="reference external" href="https://docs.pydantic.dev/latest/api/base_model/#pydantic.BaseModel" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.BaseModel</span></code></a> that extends the existing validation and
serialization capabilities in a user-friendly format. <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> is a powerful data container that, in combination with
<a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Option" title="xtl.common.options.Option"><code class="xref py py-func docutils literal notranslate"><span class="pre">Option()</span></code></a>, can facilitate arbitrary validators and serializers in a slim syntax. This module is used internally to parse
configuration from the <code class="docutils literal notranslate"><span class="pre">xtl.toml</span></code> file and to validate any modifications on the <a class="reference internal" href="../api/xtl.html#xtl.settings" title="xtl.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xtl.settings</span></code></a> object.</p>
<section id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading">#</a></h2>
<p>The module provides two objects: <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Option" title="xtl.common.options.Option"><code class="xref py py-func docutils literal notranslate"><span class="pre">Option()</span></code></a> and <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a>, which are wrappers around <a class="reference external" href="https://docs.pydantic.dev/latest/api/fields/#pydantic.fields.Field" title="(in Pydantic v0.0.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pydantic.Field()</span></code></a> and <a class="reference external" href="https://docs.pydantic.dev/latest/api/base_model/#pydantic.BaseModel" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.BaseModel</span></code></a>,
respectively. Below is a simple example that showcases what is possible with this API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xtl.common.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">Options</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Employee</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">formatter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">gt</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    <span class="n">level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;junior&#39;</span><span class="p">,</span> <span class="s1">&#39;senior&#39;</span><span class="p">],</span>
        <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;job_level&#39;</span>
    <span class="p">)</span>
    <span class="n">contract_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cast_as</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">path_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">path_is_file</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

<span class="n">employee</span> <span class="o">=</span> <span class="n">Employee</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;john doe&#39;</span><span class="p">,</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s1">&#39;senior&#39;</span><span class="p">,</span>
    <span class="n">contract_file</span><span class="o">=</span><span class="s1">&#39;/path/to/contract.txt&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now if we call <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options.to_dict" title="xtl.common.options.Options.to_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">employee.to_dict()</span></code></a> (which is equivalent to
<a class="reference external" href="https://docs.pydantic.dev/latest/api/base_model/#pydantic.BaseModel.model_dump" title="(in Pydantic v0.0.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">employee.model_dump()</span></code></a> if you prefer the <cite>Pydantic</cite> API),
we get the following back:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">employee</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="go">{&#39;name&#39;: &#39;John Doe&#39;,</span>
<span class="go">&#39;age&#39;: 30,</span>
<span class="go">&#39;contract_file&#39;: Path(&#39;/path/to/contract.txt&#39;),</span>
<span class="go">&#39;job_level&#39;: &#39;senior&#39;}</span>
</pre></div>
</div>
<p>We notice a few things:</p>
<ol class="arabic">
<li><p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute got formatted in title case (due to <code class="docutils literal notranslate"><span class="pre">formatter</span></code>), however the stored value is still
<code class="docutils literal notranslate"><span class="pre">'john</span> <span class="pre">doe'</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">employee</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;john doe&#39;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">formatter</span></code> option only affects the serialization of the field.</p>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">age</span></code> attribute was defined as a <a class="reference external" href="https://docs.pydantic.dev/latest/api/fields/#pydantic.fields.Field" title="(in Pydantic v0.0.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pydantic.Field()</span></code></a> instead and it is still compatible with our model</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">level</span></code> attribute was renamed to <code class="docutils literal notranslate"><span class="pre">job_level</span></code> (due to <code class="docutils literal notranslate"><span class="pre">alias='job_level'</span></code> which sets the
<code class="docutils literal notranslate"><span class="pre">serialization_alias</span></code> on the <cite>Pydantic</cite> field), however the attribute is still accessible through its original name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">employee</span><span class="o">.</span><span class="n">level</span>
<span class="go">&#39;senior&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">employee</span><span class="o">.</span><span class="n">job_level</span>
<span class="go">AttributeError: &#39;Employee&#39; object has no attribute &#39;job_level&#39;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">alias</span></code> option affects only model serialization.</p>
</li>
<li><p>We checked whether the value for <code class="docutils literal notranslate"><span class="pre">level</span></code> is one of <code class="docutils literal notranslate"><span class="pre">['junior',</span> <span class="pre">'senior']</span></code> (due to <code class="docutils literal notranslate"><span class="pre">choices</span></code>). If we try to
change the value to something not in the list of choices we get a validation error:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">employee</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;ceo&#39;</span>
<span class="go">pydantic_core._pydantic_core.ValidationError: 1 validation error for Employee</span>
<span class="go">level</span>
<span class="go">  Value error, Value is not in choices: [&#39;junior&#39;, &#39;senior&#39;] [type=value_error, input_value=&#39;ceo&#39;, input_type=str]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> class has <code class="xref py py-attr docutils literal notranslate"><span class="pre">validate_assignment</span></code> set
to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">contract_file</span></code> was passed along as a <code class="docutils literal notranslate"><span class="pre">str</span></code> but is now <code class="docutils literal notranslate"><span class="pre">Path</span></code> (due to <code class="docutils literal notranslate"><span class="pre">cast_as=Path</span></code>, which performs
type casting before <cite>Pydantic</cite>'s model validation)</p></li>
<li><p>We checked whether <code class="docutils literal notranslate"><span class="pre">contract_file</span></code> exists and whether it is a file (due to <code class="docutils literal notranslate"><span class="pre">path_exists=True</span></code> and
<code class="docutils literal notranslate"><span class="pre">path_is_file=True</span></code>, which add custom <cite>Pydantic</cite> validators)</p></li>
</ol>
</section>
<section id="data-validation">
<h2>Data validation<a class="headerlink" href="#data-validation" title="Link to this heading">#</a></h2>
<p><cite>Pydantic</cite> comes with a variety of prebuilt validators that can be defined on the <a class="reference external" href="https://docs.pydantic.dev/latest/api/fields/#pydantic.fields.Field" title="(in Pydantic v0.0.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pydantic.Field()</span></code></a> level. <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Option" title="xtl.common.options.Option"><code class="xref py py-func docutils literal notranslate"><span class="pre">Option()</span></code></a> provides
support for all the existing <cite>Pydantic</cite> validators, plus a few extra ones. The complete list of validators is as
follows:</p>
<ol class="arabic simple">
<li><p>Numerical fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gt</span></code>: greater than</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ge</span></code>: greater than or equal to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lt</span></code>: less than</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">le</span></code>: less than or equal to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multiple_of</span></code>: multiple of</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_inf_nan</span></code>: allow infinity or NaN values</p></li>
</ul>
</li>
<li><p>Decimal fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_digits</span></code>: maximum number of digits</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decimal_places</span></code>: number of decimal places</p></li>
<li><p>all validators for numerical fields</p></li>
</ul>
</li>
<li><p>Iterable fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code>*: number of items in the iterable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_length</span></code>: minimum number of items in the iterable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_length</span></code>: maximum number of items in the iterable</p></li>
</ul>
</li>
<li><p>String fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">regex</span></code>: regular expression</p></li>
<li><p>all validators for iterable fields</p></li>
</ul>
</li>
<li><p>Path fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path_exists</span></code>*: path exists</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path_is_file</span></code>*: path is a file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path_is_dir</span></code>*: path is a directory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path_is_absolute</span></code>*: path is absolute</p></li>
</ul>
</li>
<li><p>Enumeration fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">choices</span></code>*: list of valid values</p></li>
</ul>
</li>
</ol>
<p>Validators marked with an asterisk (*) are implemented by XTL directly.</p>
<section id="type-casting">
<h3>Type casting<a class="headerlink" href="#type-casting" title="Link to this heading">#</a></h3>
<p>A special case of validator is generated when using the <code class="docutils literal notranslate"><span class="pre">cast_as</span></code> argument. This creates a
<a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.BeforeValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.BeforeValidator</span></code></a> that is called on the raw input data before any other validation is performed, and
enables type casting.</p>
<p><cite>Pydantic</cite> already performs type coercion on certain values by default, unless <code class="docutils literal notranslate"><span class="pre">strict=True</span></code> is explicitly set either
on <a class="reference external" href="https://docs.pydantic.dev/latest/api/fields/#pydantic.fields.Field" title="(in Pydantic v0.0.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pydantic.Field()</span></code></a> or <a class="reference external" href="https://docs.pydantic.dev/latest/api/base_model/#pydantic.BaseModel" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.BaseModel</span></code></a>. For example, in if a model field is defined as <code class="docutils literal notranslate"><span class="pre">int</span></code>, then passing a integer as <code class="docutils literal notranslate"><span class="pre">str</span></code> or
as <code class="docutils literal notranslate"><span class="pre">float</span></code> will be coerced into type <code class="docutils literal notranslate"><span class="pre">int</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CoercionModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">CoercionModel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">CoercionModel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<p>Details about <cite>Pydantic</cite>â€™s type coercion can be found in the
<a class="reference external" href="https://docs.pydantic.dev/latest/concepts/conversion_table/">documentation</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cast_as</span></code> argument provides some additional functionality, where it first checks if the value is of the correct
type, and only attempts to type cast if not. An exemplary use case would be when an argument needs to be defined as a
<code class="docutils literal notranslate"><span class="pre">list[Any]</span></code> but either a list or a single value could be passed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">from</span><span class="w"> </span><span class="nn">xtl.common.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">Options</span>

 <span class="k">class</span><span class="w"> </span><span class="nc">CoercionModel</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
     <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cast_as</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

<span class="hll"> <span class="n">model</span> <span class="o">=</span> <span class="n">CoercionModel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span> <span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
 <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>

 <span class="n">model</span> <span class="o">=</span> <span class="n">CoercionModel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">])</span>
 <span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
 <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>Pydantic</cite> would have failed to coerce the value into a list in the first call.</p>
<p>Type casting is also useful when using custom types in models:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">xtl.common.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">Options</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Animal</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">species</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Pet</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="n">animal</span><span class="p">:</span> <span class="n">Animal</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cast_as</span><span class="o">=</span><span class="n">Animal</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">pet</span> <span class="o">=</span> <span class="n">Pet</span><span class="p">(</span><span class="n">animal</span><span class="o">=</span><span class="s1">&#39;Tyrannosaurus rex&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Otto&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pet</span><span class="o">.</span><span class="n">animal</span><span class="p">,</span> <span class="n">Animal</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> has <code class="xref py py-attr docutils literal notranslate"><span class="pre">arbitrary_types_allowed</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
</section>
<section id="custom-validation">
<h3>Custom validation<a class="headerlink" href="#custom-validation" title="Link to this heading">#</a></h3>
<p>In <cite>Pydantic</cite> custom field validation can be done by defining methods that have been decorated with the
<a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.field_validator" title="(in Pydantic v0.0.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;field_validator</span></code></a> decorator. In <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> this can additionally be achieved by passing
a custom validation function to the <code class="docutils literal notranslate"><span class="pre">validator</span></code> argument of <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Option" title="xtl.common.options.Option"><code class="xref py py-func docutils literal notranslate"><span class="pre">Option()</span></code></a>.</p>
<p>Any custom validation function should be first wrapped in a <a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.BeforeValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.BeforeValidator</span></code></a> or
<a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.AfterValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.AfterValidator</span></code></a>, depending on whether it should be run on the raw input data, or the already
validated data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">AfterValidator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xtl.common.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">Options</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_odd</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Value must be odd&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>

<span class="n">IsOddValidator</span> <span class="o">=</span> <span class="n">AfterValidator</span><span class="p">(</span><span class="n">is_odd</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OddNumber</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="n">IsOddValidator</span><span class="p">)</span>

<span class="n">number</span> <span class="o">=</span> <span class="n">OddNumber</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># raises pydantic_core._pydantic_core.ValidationError: 1 validation error for OddNumber</span>
<span class="c1"># number</span>
<span class="c1">#   Value error, Value is not odd [type=value_error, input_value=4, input_type=int]</span>
</pre></div>
</div>
<p>Note the signature of the <code class="xref py py-func docutils literal notranslate"><span class="pre">is_odd()</span></code> function: It accepts a single argument, and returns it as is if the validation
is passed, otherwise it raises a <code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code>. Once all <a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.AfterValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.AfterValidator</span></code></a> have been executed, any
<code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code> that might have been raised will get aggregated into a single
<a class="reference external" href="https://docs.pydantic.dev/latest/api/pydantic_core/#pydantic_core.ValidationError" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.ValidationError</span></code></a>.</p>
<p>A few more important notes about crafting custom validators:</p>
<ul>
<li><p><strong>Value immutability</strong>: <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> allows for validators to mutate the value. This is, for example, the case for the
<a class="reference internal" href="../api/xtl.common.validators.html#xtl.common.validators.CastAsValidator" title="xtl.common.validators.CastAsValidator"><code class="xref py py-func docutils literal notranslate"><span class="pre">CastAsValidator</span></code></a> which performs type casting. This ensure that the
right value is propagated to the next validator. The model value is, however, only mutated from the input value if
all validators succeed.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>In general, validators should only check the value. Be very careful when mutating the value, as this can lead to
unexpected behavior, for example in dictionaries.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Mutating the value affects the way it is stored internally. If you find yourself crafting validators that change
the way the value is output upon serialization, you should be creating a <code class="docutils literal notranslate"><span class="pre">formatter</span></code> instead (see:
<a class="reference internal" href="#data-formatting">Data formatting</a>)</p>
</div>
</li>
<li><p><strong>Validation order</strong>: Validators are applied sequentially. The order of execution is as follows:</p>
<ol class="arabic simple">
<li><p><em>Raw data received</em></p></li>
<li><p><a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.BeforeValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.BeforeValidator</span></code></a> by XTL (if any)</p></li>
<li><p><a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.BeforeValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.BeforeValidator</span></code></a> by user (if any)</p></li>
<li><p><cite>Pydantic</cite>'s internal validation and model initialization logic</p></li>
<li><p><a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.AfterValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.AfterValidator</span></code></a> by XTL (if any)</p></li>
<li><p><a class="reference external" href="https://docs.pydantic.dev/latest/api/functional_validators/#pydantic.functional_validators.AfterValidator" title="(in Pydantic v0.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.AfterValidator</span></code></a> by user (if any)</p></li>
<li><p><em>Model instance is returned</em></p></li>
</ol>
</li>
</ul>
</section>
</section>
<section id="data-formatting">
<h2>Data formatting<a class="headerlink" href="#data-formatting" title="Link to this heading">#</a></h2>
<p>Once our model has been instantiated, we might want to pass all its data to another function, save it in a file, display
it to the user, <em>etc</em>. Many times the way the data is stored inside the model and the way it is presented to the outside
world have different requirements. In general, this concept is called
<a class="reference external" href="https://docs.pydantic.dev/latest/concepts/serialization/">serialization</a> in <cite>Pydantic</cite>, and in XTL it can be
controlled by the <code class="docutils literal notranslate"><span class="pre">formatter</span></code> and <code class="docutils literal notranslate"><span class="pre">alias</span></code> arguments in <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Option" title="xtl.common.options.Option"><code class="xref py py-func docutils literal notranslate"><span class="pre">Option()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xtl.common.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">Options</span>

<span class="k">def</span><span class="w"> </span><span class="nf">PathUri</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">as_uri</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;param_a&#39;</span><span class="p">)</span>
    <span class="n">b</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;param_b&#39;</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="n">file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="n">PathUri</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="go">{&#39;param_a&#39;: 1,</span>
<span class="go">&#39;param_b&#39;: &#39;VALUE&#39;,</span>
<span class="go">&#39;file&#39;: &#39;file:///path/to/file&#39;}</span>
</pre></div>
</div>
</section>
<section id="model-i-o">
<h2>Model I/O<a class="headerlink" href="#model-i-o" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> models can be serialized to and deserialized from Python dictionaries, JSON and TOML files and/or strings.
There are aptly named methods (<code class="docutils literal notranslate"><span class="pre">from_*</span></code>/<code class="docutils literal notranslate"><span class="pre">to_*</span></code>) for each purpose.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">xtl.common.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">Options</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NestedModel</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span>
                    <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;This is 10 times the original&#39;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ParentModel</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="n">b</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                      <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;This is an aliased value&#39;</span><span class="p">)</span>
    <span class="n">nested</span><span class="p">:</span> <span class="n">NestedModel</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">NestedModel</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">ParentModel</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.</span><span class="p">,</span> <span class="s1">&#39;nested&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}})</span>
<span class="n">p</span><span class="o">.</span><span class="n">to_toml</span><span class="p">(</span><span class="s1">&#39;output.toml&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This will output an <code class="docutils literal notranslate"><span class="pre">output.toml</span></code> file, which will include all the field descriptions as inline comments to the
values.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">output.toml</span></code></span><a class="headerlink" href="#id1" title="Link to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>c = 3.0 # This is an aliased value

[nested]
a = 20 # This is 10 times the original
</pre></div>
</div>
</div>
</section>
<section id="environment-variables">
<h2>Environment variables<a class="headerlink" href="#environment-variables" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> also support parsing of environment variables on string fields. Due to safety considerations, this behaviour
is disabled by default. To enable environment variable parsing, you need to pass <code class="docutils literal notranslate"><span class="pre">_parse_env=True</span></code> during model
instantiation. Any strings that contain expressions in the form of <code class="docutils literal notranslate"><span class="pre">${VARIABLE}</span></code> will be replaced by the value of the
respective environment variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xtl.common.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">Options</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Settings</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SECRET&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;alakazam&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Settings</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s1">&#39;secret is $</span><span class="si">{SECRET}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: &#39;secret is ${SECRET}&#39;}</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">Settings</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s1">&#39;secret is $</span><span class="si">{SECRET}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">_parse_env</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span class="go">{&#39;a&#39;: &#39;secret is alakazam&#39;}</span>
</pre></div>
</div>
<p>If an environment variable is not set, then the content will be replaced with an empty string. The parsing of
environment variables is a mutable operation, meaning that the value of the field is replaced with that of the
variable. Changing the environment variable after model instantiation will have no effect on the fieldâ€™s value, unless
the same expression is reassigned to the field, and the model undergoes validation again.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_parse_env</span></code> argument is only local in scope, meaning that it only applies to the current model. In case of
nested <a class="reference internal" href="../api/xtl.common.options.html#xtl.common.options.Options" title="xtl.common.options.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> models, environment variable parsing will <strong>not</strong> be propagated from the parent model to its childs.</p>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Shared utilities</p>
      </div>
    </a>
    <a class="right-next"
       href="tables.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tables</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quickstart">Quickstart</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-validation">Data validation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-casting">Type casting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-validation">Custom validation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-formatting">Data formatting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-i-o">Model I/O</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-variables">Environment variables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dimitris P. Triandafillidis
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2020-2025, Dimitris P. Triandafillidis.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>


    
  <footer class="bd-footer">
  </footer>
    <div class="version-selector">
        <label for="version-dropdown">Documentation Version:</label>
        <select id="version-dropdown" onchange="if(this.value) window.location.href=this.value">
            <option value="./latest/">Latest Stable</option>
            <option value="./dev/">Development</option>
        </select>
    </div>

    <script>
        const versionsJson = '[]';

        // Add version selector to header buttons
        document.addEventListener('DOMContentLoaded', function() {
            const headerButtons = document.querySelector('.article-header-buttons');
            if (!headerButtons) return;

            // Create and insert version selector
            const versionSelector = document.createElement('div');
            versionSelector.className = 'version-selector-nav';
            versionSelector.innerHTML = '<select id="nav-version-dropdown" title="Documentation Version" ' +
                'onchange="if(this.value) window.location.href=this.value">' +
                '<option value="./latest/">Latest</option>' +
                '<option value="./dev/">Dev</option></select>';

            headerButtons.insertBefore(versionSelector, headerButtons.firstChild);

            // Synchronize with main dropdown
            const mainDropdown = document.getElementById('version-dropdown');
            const navDropdown = document.getElementById('nav-version-dropdown');
            if (!mainDropdown || !navDropdown) return;

            // Detect current version based on URL path
            const detectCurrentVersion = function() {
                const path = window.location.pathname;
                const isLatest = path.includes('/latest/');
                const isDev = path.includes('/dev/');

                // Look through all options to find matching ones
                return function(select) {
                    let found = false;
                    Array.from(select.options).forEach(function(option) {
                        if ((isLatest && option.value.includes('latest')) ||
                            (isDev && option.value.includes('dev'))) {
                            option.selected = true;
                            found = true;
                        }
                    });

                    // If no version detected in URL, try to find exact path match
                    if (!found && path) {
                        Array.from(select.options).forEach(function(option) {
                            if (option.value && path.endsWith(option.value.replace('./', '/'))) {
                                option.selected = true;
                            }
                        });
                    }
                };
            };

            // Ensure all paths use relative URLs
            const makePathsRelative = function(select) {
                Array.from(select.options).forEach(function(option) {
                    if (option.value && option.value.startsWith('/')) {
                        option.value = '.' + option.value;
                    }
                });
            };

            makePathsRelative(mainDropdown);
            makePathsRelative(navDropdown);

            // Set current version in both dropdowns
            const setCurrentVersion = detectCurrentVersion();
            setCurrentVersion(mainDropdown);
            setCurrentVersion(navDropdown);

            // Watch for changes to the main dropdown
            new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                        let newOptionsAdded = false;

                        Array.from(mutation.addedNodes).forEach(function(node) {
                            if (node.nodeName === 'OPTION' && node.value &&
                                !navDropdown.querySelector(`option[value="${node.value}"]`)) {
                                const clone = node.cloneNode(true);

                                // Make sure path is relative
                                if (clone.value.startsWith('/')) {
                                    clone.value = '.' + clone.value;
                                }

                                // Make the label shorter
                                if (clone.textContent.includes('v')) {
                                    clone.textContent = clone.textContent.trim();
                                }

                                navDropdown.appendChild(clone);
                                newOptionsAdded = true;
                            }
                        });

                        // If new options were added, reapply version detection
                        if (newOptionsAdded) {
                            setCurrentVersion(navDropdown);

                            // If main dropdown has a selection, match it
                            if (mainDropdown.selectedIndex > 0) {
                                navDropdown.value = mainDropdown.value;
                            }
                        }
                    }
                });
            }).observe(mainDropdown, { childList: true });
        });
    </script>
    <script src="../_static/js/version-selector.js"></script>

    <!-- Fix absolute paths in version-selector.js -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Override the version-selector.js behavior for path creation
            const originalAppendChild = HTMLSelectElement.prototype.appendChild;
            HTMLSelectElement.prototype.appendChild = function(element) {
                if (this.id === 'version-dropdown' || this.id === 'nav-version-dropdown') {
                    if (element.nodeName === 'OPTION' && element.value && element.value.startsWith('/')) {
                        element.value = '.' + element.value;
                    }

                    // Check if this option should be selected based on the current URL
                    if (element.nodeName === 'OPTION' && element.value) {
                        const path = window.location.pathname;
                        const versionPath = element.value.replace('./', '/');
                        if (path.includes(versionPath)) {
                            element.selected = true;
                        }
                    }
                }
                return originalAppendChild.call(this, element);
            };
        });
    </script>

  </body>
</html>